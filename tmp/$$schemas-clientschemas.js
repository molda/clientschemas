(function(w){var _schemas={"Contact":{"authorize":true,"role":"@admin"}};w.SCHEMA=function(name){return new SchemaInstance(name)};function SchemaInstance(name){var self=this;self.name=name;self.commands=[];self.callback=function(){};return self};SchemaInstance.prototype.get=function(options,callback){var self=this;if(typeof(options)==='function'){callback=options;options={}}self.commands.push({name:'$get',callback:callback?true:false,params:[options]});if(callback)self.callback=callback;return self};SchemaInstance.prototype.query=function(options,callback){var self=this;if(typeof(options)==='function'){callback=options;options={}}self.commands.push({name:'$query',callback:callback?true:false,params:[options]});if(callback)self.callback=callback;return self};SchemaInstance.prototype.save=function(options,callback){var self=this;if(typeof(options)==='function'){callback=options;options={}}self.commands.push({name:'$save',callback:callback?true:false,params:[options]});if(callback)self.callback=callback;return self};SchemaInstance.prototype.workflow=function(name,options,callback){var self=this;if(typeof(options)==='function'){callback=options;options={}}self.commands.push({name:'$workflow',callback:callback?true:false,params:[name,options]});if(callback)self.callback=callback;return self};SchemaInstance.prototype.operation=function(name,options,callback){var self=this;if(typeof(options)==='function'){callback=options;options={}}self.commands.push({name:'$operation',callback:callback?true:false,params:[name,options]});if(callback)self.callback=callback;return self};SchemaInstance.prototype.exec=function(callback){var self=this;if(callback)self.callback=callback;if(!_schemas[self.name]){return self.callback('SCHEMA_NOT_AVAILABLE')} _request(self.name,{commands:self.commands},function(err,response){self.callback(err,response)})};function _request(schemaname,data,callback){var xhr=new XMLHttpRequest();var cb_called=false;xhr.onreadystatechange=function(){if(this.readyState==4){if(this.status==200)if(!cb_called)return callback(null,JSON.parse(this.responseText));else!cb_called&&responseError();cb_called=true}};xhr.onerror=responseError;xhr.ontimeout=responseError;function responseError(){!cb_called&&callback('Error: Request failed');cb_called=true}xhr.open('POST','/$$schemas/'+schemaname,true);xhr.setRequestHeader("Content-Type","application/json");xhr.send(JSON.stringify(data))}})(window);